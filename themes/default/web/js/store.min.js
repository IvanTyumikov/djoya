function showNotify(t,e,a){$("#notifications").html('<div class="notifications-'+e+'">'+a+"</div>").fadeIn().delay(3e3).fadeOut()}function getCookie(t){t=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function setCookie(t,e,a){var i,o=(a=a||{}).expires;"number"==typeof o&&o&&((i=new Date).setTime(i.getTime()+1e3*o),o=a.expires=i),o&&o.toUTCString&&(a.expires=o.toUTCString());var n,s=t+"="+(e=encodeURIComponent(e));for(n in a){s+="; "+n;var r=a[n];!0!==r&&(s+="="+r)}document.cookie=s}function numberAnimate(a,i,o,n){var s=(new Date).getTime();setTimeout(function(){var t=((new Date).getTime()-s)/n,e=Math.floor((o-i)*t+i);a.html(t<1?e:o),t<1&&setTimeout(arguments.callee,10)},5)}function numberWithSpaces(t){t=t.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),t.join(".")}function ChangeUrl(t,e){e={Page:t,Url:e};history.pushState(e,e.Page,e.Url)}$(document).ready(function(){var t="#shopping-cart-widget",e=$("#result-price"),s=parseFloat($("#base-price").val()),o=$("#product-quantity"),a=($("#product-quantity-input"),$("#cart-shipping-cost")),i=$("#cart-full-cost"),n=$("#cart-full-cost-with-shipping"),r=function(){var t=$(this).parents(".js-product-item"),e=$(this).data("src"),a=$(this).data("srcset"),i=$(this).data("key");t.find(".js-product-image img").attr("src",e),t.find(".js-product-image source").attr("srcset",a),t.find(".js-item-image-dots").removeClass("active"),t.find(".js-item-image-dots[data-key="+i+"]").addClass("active")};$(".js-image-lists").hover(r),$(document).delegate(".js-sort-box","click",function(t){$(this).addClass("active")}),$(document).delegate("body","click",function(t){$(t.target).parents(".js-sort-box").length<1&&$(".js-sort-box").removeClass("active")}),$(document).delegate(".sort-box__list","click",function(){var e=$(this),a=e.html();return $(".product__items").addClass("list-view-loading"),$.ajax({type:"GET",url:e.attr("data-href"),success:function(t){$(".product__items").html($(t).find(".product__items").html()),$(".sort-box__lists").html($(t).find(".sort-box__lists").html()),$(".product__items").removeClass("list-view-loading"),e.addClass("active"),$(".js-sort-box").find("#sort-box-value").html(a),$(".js-sort-box").removeClass("active"),$(".js-image-lists").hover(r)}}),!1}),$(document).delegate(".js-product-variant .product-variant__value","click",function(t){$(this).parent().addClass("active")}),$(document).delegate("body","click",function(t){$(t.target).parents(".js-product-variant").length<1&&$(".js-product-variant").removeClass("active")}),$(document).delegate(".js-variant-price","click",function(){var t=$(this).find(".value").html();$(".js-product-variant").find(".product-variant__value > .value").html(t),$(".js-product-variant").removeClass("active")}),$(document).delegate(".js-load-attribute","click",function(){var e=$(this),t=e.attr("data-action-attribute"),a={productView:"attribute",YUPE_TOKEN:yupeToken};return e.addClass("loading"),$.ajax({type:"post",url:t,data:a,success:function(t){e.parents(".wg-product-attr").html($(t).html()),e.removeClass("loading")}}),!1}),$(".js-product-item-image").slick({fade:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,autoplay:!1,speed:200,dots:!0,arrows:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:1}}]}),$(document).delegate(".js-items-count","click",function(){$(this).toggleClass("active")}),$(document).delegate("body","click",function(t){$(t.target).parents(".js-items-count").length<1&&$(".js-items-count").removeClass("active")}),$(document).delegate(".items-count__list","click",function(){var t=$(this);return setCookie("store_count",t.data("count"),{path:"/"}),$(".items-count__list").removeClass("active"),t.addClass("active"),C(),!1}),$(document).delegate(".raiting-list-form .raiting-list__item","click",function(){var t=$(this),e=t.data("text"),a=t.data("id");return $(".raiting-list-form .raiting-list__item").removeClass("active"),t.addClass("active").prevAll(".raiting-list__item").addClass("active"),$("#js-raiting-val-text").text(e),t.parent().addClass("no-hover"),$("#Review_rating").val(a),!1});function c(){v.prop("value",l),h.prop("value",u)}var d,l,u,p,f,m=$("#js-range-price"),v=$(".js-from-price"),h=$(".js-to-price"),g=$("#js-range-price").data("min"),y=$("#js-range-price").data("max");function _(){$(".js-thumbnails-preview-slider").not(".slick-initialized").slick({fade:!1,infinite:!1,dots:!1,arrows:!0,speed:100,slidesToShow:1,slidesToScroll:1,autoplay:!1,asNavFor:".thumbnails-small",prevArrow:'<span class="icon-prev slick-arrow"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.917 19.6803L15.5767 19.0252C15.7827 18.819 15.8962 18.5447 15.8962 18.2515C15.8962 17.9585 15.7827 17.6839 15.5767 17.4777L8.10309 10.0045L15.5849 2.52262C15.791 2.31677 15.9043 2.04213 15.9043 1.74912C15.9043 1.45611 15.791 1.18131 15.5849 0.975293L14.9293 0.320003C14.503 -0.106668 13.8085 -0.106668 13.3822 0.320003L4.44209 9.22804C4.23623 9.4339 4.09119 9.70821 4.09119 10.0038V10.0072C4.09119 10.3004 4.2364 10.5747 4.44209 10.7806L13.3579 19.6803C13.5638 19.8865 13.8464 19.9997 14.1394 20C14.4326 20 14.7113 19.8865 14.917 19.6803Z" fill="#757575"/></svg></span>',nextArrow:'<span class="icon-next slick-arrow"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.08303 0.319677L4.42335 0.974806C4.21733 1.18099 4.10383 1.4553 4.10383 1.74847C4.10383 2.04148 4.21733 2.31612 4.42335 2.5223L11.8969 9.99553L4.41506 17.4774C4.20904 17.6832 4.0957 17.9579 4.0957 18.2509C4.0957 18.5439 4.20904 18.8187 4.41506 19.0247L5.07067 19.68C5.49702 20.1067 6.19149 20.1067 6.61784 19.68L15.5579 10.772C15.7638 10.5661 15.9088 10.2918 15.9088 9.99618V9.99276C15.9088 9.69959 15.7636 9.42528 15.5579 9.21942L6.64207 0.319677C6.43621 0.113497 6.15361 0.000326157 5.8606 0C5.56742 0 5.28872 0.113497 5.08303 0.319677Z" fill="#757575"/></svg></span>'})}function b(){$(".thumbnails-small").not(".slick-initialized").slick({infinite:!1,autoplay:!1,dots:!1,arrows:!1,speed:100,slidesToShow:4,vertical:!0,asNavFor:".js-thumbnails-preview-slider",focusOnSelect:!0,responsive:[{breakpoint:577,settings:{slidesToShow:4,arrows:!1,vertical:!1}}]})}function k(){var t=$(".template-product__item.active");"_item-list"!=t.data("view")&&"_item-list-big"!=t.data("view")||($(".template-product__item").addClass("active"),t.removeClass("active"),setCookie("store_item","_item",{path:"/"}),setTimeout(C(),3e3))}function C(){var t=$("#store-filter"),a=$(".filter").offset().top-50,t=t.serialize();return history.pushState(null,location.title,location.pathname+"?"+t),""==t&&(t={}),$(".product__items").addClass("ajax-load"),$.fn.yiiListView.update("product-box",{data:t,url:"",enableHistory:!0,complete:function(t){var e=$(t.responseText).find(".filter__search").html(),t=$(t.responseText).find(".sort-box__lists").html();$(".filter__search").html(e),$(".sort-box__lists").html(t),$(".ajax-loading").delay(100).fadeOut(500),$("body,html").animate({scrollTop:a+"px"},400),$(".catalog-content__sidebar").removeClass("active"),$(".js-product-zoom").zoom({on:"mouseover"}),$(".product-list-big-preview__img").zoom({on:"grab"}),$(".js-image-lists").hover(r)}}),!1}function w(t){var e=t.parents("form"),a=e.find(".product-quantity-input"),t=e.find("#result-price .value"),e=e.find("#result-price").data("price"),e=numberWithSpaces(parseFloat((a.val()*e).toFixed(0)));t.html(e)}function x(){$(t).load($("#cart-widget").data("cart-widget-url"))}function j(){var a=[];return $.each($(".coupon-input"),function(t,e){e=$(e);a.push({code:e.data("code"),name:e.data("name"),value:e.data("value"),type:e.data("type"),min_order_price:e.data("min-order-price"),free_shipping:e.data("free-shipping")})}),a}function T(){var a=0;$.each($(".position-sum-price"),function(t,e){a+=parseFloat($(e).text())});let i=0;var t=j();return $.each(t,function(t,e){if(a>=e.min_order_price)switch(e.type){case 0:i+=parseFloat(e.value).toFixed(0);break;case 1:i+=(parseInt(e.value)/100).toFixed(2)*a.toFixed(2)}}),i>a?0:a-i}function q(){i.html(T()),I(),F(),L()}function I(){var i=T();$.each($('input[name="Order[delivery_id]"]'),function(t,e){var a=$(e),e=a.data("available-from");e.length&&parseFloat(e)>=i?(a.prop("checked")&&N(),a.prop("disabled",!0)):a.prop("disabled",!1)})}function N(){$('input[name="Order[delivery_id]"]:not(:disabled):first').prop("checked",!0)}function S(){var a=T(),t=j(),i=!1;if($.each(t,function(t,e){e.free_shipping&&a>=e.min_order_price&&(i=!0)}),i)return 0;t=$('input[name="Order[delivery_id]"]:checked');return!t[0]||parseInt(t.data("separate-payment"))||parseFloat(t.data("free-from"))<=a?0:parseFloat(t.data("price"))}function F(){a.html(S()),L()}function L(){n.html(S()+T())}function U(){q()}0<m.length&&(m.ionRangeSlider({onStart:function(t){l=t.from,u=t.to},onChange:function(t){l=t.from,u=t.to,c()},onFinish:function(t){l=t.from,u=t.to,c(),C()}}),d=m.data("ionRangeSlider"),p=function(){d.update({from:l,to:u})},v.focusout(function(t){(l=+$(this).prop("value"))<g&&(l=g),u<l&&(l=u),c(),p()}),h.focusout(function(t){u=+$(this).prop("value"),y<u&&(u=y),u<l&&(u=l),c(),p()})),$(".filter-price").keypress(function(t){console.log(t),13==t.which&&C()}),$(document).delegate(".js-product-info-color","click",function(){var e=$(this),t=e.parents(".product-info-color").data("action-images-color"),a=e.data("product-id"),i=e.data("option-value"),o=e.data("option-name");e.parents(".product-info-color").find(".js-product-info-color").removeClass("active"),$("#thumbnails").addClass("loading"),$.ajax({type:"post",url:t,data:{view:"images-product",productId:a,optionValue:i,YUPE_TOKEN:yupeToken},success:function(t){e.addClass("active"),e.parents(".product-info-color").find(".product-info-color__value").html(o),e.parents(".product-view").find(".thumbnails").html(t),e.parents(".product-view").find(".product-info__variants-hidden-filds input").prop("checked",!1),e.parents(".product-view").find(".product-info__variants-hidden-filds input[data-atribute-id="+i+"]").prop("checked",!0),_(),setTimeout(function(){b(),$("#thumbnails").removeClass("loading")},100)}})}),_(),b(),$(document).delegate(".js-sharing-show","click",function(){$(this).parent().toggleClass("active")}),$(document).mouseup(function(t){var e=$(".sharing");0===e.has(t.target).length&&e.removeClass("active")}),$(document).delegate(".js-cart-sidebar-more","click",function(t){var e=$(this).find("span").attr("data-text");return $(this).parent().find(".cart-sidebar-info").hasClass("show")?$(this).parent().find(".cart-sidebar-info.show").addClass("hidden").removeClass("show"):$(this).parent().find(".cart-sidebar-info.hidden").addClass("show").removeClass("hidden"),$(this).find("span").attr("data-text",$(this).find("span").text()),$(this).find("span").text(e),!1}),$(document).delegate(".button-mobile-filter","click",function(){return $(".catalog-content__sidebar").addClass("active"),!1}),$(document).delegate(".sidebar-box__close","click",function(){return $(".catalog-content__sidebar").removeClass("active"),!1}),$(".catalog-content__sidebar").on("click",function(t){if($(t.target).hasClass("active"))return $(".catalog-content__sidebar").removeClass("active"),$(".button-mobile-filter").removeClass("active"),!1}),$(window).resize(function(){var t=window.innerWidth;1240<t&&($(".menu-fix__icon-close").removeClass("active"),$(".menu-fix__icon-menu").removeClass("no-active"),$("body").removeClass("bodymenu"),$(".menu-fix").removeClass("active"),$(".menu-fix__box").css({display:"",left:""}).removeClass("active"),$(".sidebar-box").removeClass("active"),$("#store-filter").removeClass("active")),t<991&&k(),$("div").hasClass("lazySlideImg")&&$(".lazySlideImg").each(function(){lazySlideImg($(this))})}),window.innerWidth<991&&k(),$(document).delegate(".template-product__item","click",function(){return setCookie("store_item",$(this).data("view"),{path:"/"}),$(".template-product__item").removeClass("active"),$(this).addClass("active"),C(),!1}),$(document).delegate(".filter-block__header","click",function(t){var e=$(this).parents(".filter-block");return $(this).toggleClass("no-active"),"filter-block__body filter-block__attribute"==e.find(".filter-block__body").attr("class")?setTimeout(function(){e.find(".filter-block__body").toggle()},300):e.find(".filter-block__body").toggle(),setTimeout(function(){e.find(".filter-block__body").toggleClass("no-active")},100),!1}),$(document).delegate("#store-filter input[type=checkbox]","change",function(t){return C(),!1}),$(document).delegate("#store-filter input[type=radio]","change",function(t){return C(),!1}),$(document).delegate("#product-box .pagination li a","click",function(){var t=$(".filter").offset().top-50;$("body,html").animate({scrollTop:t+"px"},400),setTimeout(function(){$(".js-image-lists").hover(r)},1e3)}),$(document).delegate(".product-quantity-increase","click",function(){var t=$(this),e=t.parent().find(".product-quantity-input");e.val(parseInt(e.val())+1).trigger("change"),w(t)}),$(document).delegate(".product-quantity-decrease","click",function(){var t=$(this),e=t.parent().find(".product-quantity-input");1<parseInt(e.val())&&(e.val(parseInt(e.val())-1).trigger("change"),w(t))}),$('.product-variant input[type="radio"]').click(function(){!function(){var i=s,o=[],t=$('.product-variant input[type="radio"]:checked'),a=!1;$.each(t,function(t,e){!e.value||2===(e={amount:$(e).data("amount"),type:$(e).data("type")}).type&&(a?i<e.amount&&(i=e.amount):(i=e.amount,a=!0))});var n=i;$.each(t,function(t,e){if(e.value){var a={amount:$(e).data("amount"),type:$(e).data("type")};switch(o.push(a),a.type){case 0:n+=a.amount;break;case 1:n+=i*(a.amount/100)}}}),t=$("#product-quantity-input").val(),t=numberWithSpaces(parseFloat(n.toFixed(2))*t),e.find(".value").html(t),e.attr("data-price",parseFloat(n.toFixed(2)))}()}),$("#product-quantity-input").change(function(t){var e=$(this);quantity=parseInt(e.val()),(quantity<=0||isNaN(quantity))&&(quantity=1);var a=e.parents(".spinput"),i=parseInt(a.data("min-value")),a=parseInt(a.data("max-value"));quantity<i?quantity=i:quantity>a&&(quantity=a),e.val(quantity),o.text(quantity)}),$("body").on("click","#add-product-to-cart",function(t){t.preventDefault();var e=$(this),t=$(this).parents("form");$.ajax({type:"post",dataType:"json",data:t.serialize(),url:t.attr("action"),success:function(t){t.result&&x(),showNotify(e,t.result?"success":"danger",t.data)}})}),$("body").on("click",".quick-add-product-to-cart",function(t){t.preventDefault();var e=$(this),t={"Product[id]":e.data("product-id")};t[yupeTokenName]=yupeToken,$.ajax({url:e.data("cart-add-url"),type:"post",data:t,dataType:"json",success:function(t){t.result&&(x(),e.off("click",".quick-add-product-to-cart")),showNotify(e,t.result?"success":"danger",t.data)}})}),$(".cart-quantity-increase").click(function(){var t=$($(this).data("target"));t.val(parseInt(t.val())+1).trigger("change")}),$(".cart-quantity-decrease").click(function(){var t=$($(this).data("target"));1<parseInt(t.val())&&t.val(parseInt(t.val())-1).trigger("change")}),o.change(function(t){var e=$(this);quantity=parseInt(e.val()),(quantity<=0||isNaN(quantity))&&(quantity=1),e.val(quantity)}),$(".cart-delete-product").click(function(t){t.preventDefault();let e=$(this),a={id:e.data("position-id")};a[yupeTokenName]=yupeToken,$.ajax({url:yupeCartDeleteProductUrl,type:"post",data:a,dataType:"json",success:function(t){t.result&&(e.parents(".cart-info__row").remove(),q(),0<$(".cart-info__row").length?x():(x(),$(".cart-index__main").html(yupeCartEmptyMessage)))}})}),$(".position-count").change(function(){var t=$(this).parents(".cart-info__row"),e=t.find(".position-count");positionCountEl2=t.find(".position-count2");var a=parseInt(e.val()),i=t.find(".position-id").val();(a<=0||isNaN(a))&&(a=1);var o=t.find(".spinput"),n=parseInt(o.data("min-value")),o=parseInt(o.data("max-value"));a<n?a=n:o<a&&(a=o),e.val(a),positionCountEl2.html(a);o=t.find(".js-position-price").html();t.find(".js-position-sum-price").html(Math.round(a*o).toFixed(1)),e=t,o=parseInt(e.find(".position-count").val()),t=parseFloat(e.find(".position-price").text()),e.find(".js-position-sum-price").html(Math.round(t*o).toFixed(0)),q(),(i={quantity:a,id:i=i})[yupeTokenName]=yupeToken,$.ajax({url:yupeCartUpdateUrl,type:"post",data:i,dataType:"json",success:function(t){t.result&&x()}})}),$(document).delegate('input[name="Order[delivery_id]"]',"change",function(){console.log(F()),F()}),I(),N(),U(),$("#start-payment").on("click",function(){$(".payment-method-radio:checked").parents(".payment-method").find("form").submit()}),$("body").on("click",".clear-cart",function(t){t.preventDefault();t={};t[yupeTokenName]=yupeToken,$.ajax({url:"/coupon/clear",type:"post",data:t,dataType:"json",success:function(t){t.result&&x()}})}),$("#post table").each(function(){$(this).wrap('<div class="blog-table">')}),f=null!=$(".coupons-list__item").html(),$("#add-coupon-code").click(function(t){t.preventDefault();var t=$("#coupon-code").val(),e=$(this);if(f&&""!=$("#coupon-code").val())return showNotify(e,"not-add","Вы уже добавили купон к заказу"),!1;t&&((t={code:t})[yupeTokenName]=yupeToken,$.ajax({url:"/coupon/add",type:"post",data:t,dataType:"json",success:function(t){t.result&&(window.location.reload(),f=!0),showNotify(e,t.result?"success":"danger",t.data)}}),$("#coupon-code").val(""))}),$(".coupon .close").click(function(t){t.preventDefault();t={code:$(this).siblings('input[type="hidden"]').data("code")};t[yupeTokenName]=yupeToken,$.ajax({url:"/coupon/remove",type:"post",data:t,dataType:"json",success:function(t){showNotify(this,t.result?"success":"danger",t.data),t.result&&(U(),f=!1)}})}),$("#coupon-code").keypress(function(t){13==t.which&&(t.preventDefault(),$("#add-coupon-code").click())}),$(".order-form").submit(function(){$(this).find("button[type='submit']").prop("disabled",!0)})});